<?xml version="1.0" encoding="Cp1251"?>
 <beans>
  <bean class="net.soft_systems.integrator.TopicBean"net.soft_systems.integrator.TopicBean id="root"root name="Система криптографической защиты"Система криптографической защиты>
   <child-beans>
    <bean class="net.soft_systems.crypto.beans.structure.StructureGroupBean"net.soft_systems.crypto.beans.structure.StructureGroupBean id="structure"structure name="Статическая модель"Статическая модель>
     <child-beans>
      <bean class="net.soft_systems.crypto.beans.structure.StructureBean"net.soft_systems.crypto.beans.structure.StructureBean id="structure-diagram"structure-diagram name="Диаграмма статической модели"Диаграмма статической модели>
       <child-beans/>
      </bean>
      <bean class="net.soft_systems.crypto.beans.structure.ResourceGroupBean"net.soft_systems.crypto.beans.structure.ResourceGroupBean id="resources"resources name="Защищаемая область O"Защищаемая область O>
       <child-beans>
        <bean class="net.soft_systems.crypto.beans.structure.ResourceBean"net.soft_systems.crypto.beans.structure.ResourceBean id="O1"O1 name="O1"O1 x="0.0"0.0 y="0.0"0.0/>
       </child-beans>
      </bean>
      <bean class="net.soft_systems.crypto.beans.structure.SubjectGroupBean"net.soft_systems.crypto.beans.structure.SubjectGroupBean id="subjects"subjects name="Субъекты S"Субъекты S>
       <child-beans>
        <bean class="net.soft_systems.crypto.beans.structure.SubjectBean"net.soft_systems.crypto.beans.structure.SubjectBean id="S1"S1 name="S1"S1 x="0.0"0.0 y="0.0"0.0/>
       </child-beans>
      </bean>
      <bean class="net.soft_systems.crypto.beans.structure.ThreatGroupBean"net.soft_systems.crypto.beans.structure.ThreatGroupBean id="threats"threats name="Область угроз T"Область угроз T>
       <child-beans>
        <bean class="net.soft_systems.crypto.beans.structure.ThreatBean"net.soft_systems.crypto.beans.structure.ThreatBean id="перехват"перехват name="перехват"перехват probability="0.1"0.1 x="196.0"196.0 y="26.0"26.0/>
        <bean class="net.soft_systems.crypto.beans.structure.ThreatBean"net.soft_systems.crypto.beans.structure.ThreatBean id="модификация"модификация name="модификация"модификация probability="0.2"0.2 x="210.0"210.0 y="112.0"112.0/>
        <bean class="net.soft_systems.crypto.beans.structure.ThreatBean"net.soft_systems.crypto.beans.structure.ThreatBean id="фальсификация"фальсификация name="фальсификация"фальсификация probability="0.3"0.3 x="190.0"190.0 y="392.0"392.0/>
        <bean class="net.soft_systems.crypto.beans.structure.ThreatBean"net.soft_systems.crypto.beans.structure.ThreatBean id="перехват, модификация"перехват, модификация name="перехват, модификация"перехват, модификация probability="0.15"0.15 x="194.0"194.0 y="215.0"215.0/>
       </child-beans>
      </bean>
      <bean class="net.soft_systems.crypto.beans.structure.ProtectionGroupBean"net.soft_systems.crypto.beans.structure.ProtectionGroupBean id="protections"protections name="Системные защиты M"Системные защиты M>
       <child-beans>
        <bean class="net.soft_systems.crypto.beans.structure.ProtectionBean"net.soft_systems.crypto.beans.structure.ProtectionBean id="M1"M1 name="M1"M1 strength="0.78"0.78 x="631.0"631.0 y="28.0"28.0/>
        <bean class="net.soft_systems.crypto.beans.structure.ProtectionBean"net.soft_systems.crypto.beans.structure.ProtectionBean id="M2"M2 name="M2"M2 strength="0.0"0.0 x="629.0"629.0 y="134.0"134.0/>
        <bean class="net.soft_systems.crypto.beans.structure.ProtectionBean"net.soft_systems.crypto.beans.structure.ProtectionBean id="M3"M3 name="M3"M3 strength="0.95"0.95 x="591.0"591.0 y="411.0"411.0/>
        <bean class="net.soft_systems.crypto.beans.structure.ProtectionBean"net.soft_systems.crypto.beans.structure.ProtectionBean id="M4"M4 name="M4"M4 strength="0.98"0.98 x="574.0"574.0 y="286.0"286.0/>
       </child-beans>
      </bean>
      <bean class="net.soft_systems.crypto.beans.structure.BoundaryGroupBean"net.soft_systems.crypto.beans.structure.BoundaryGroupBean id="boundaries"boundaries name="Набор барьеров B"Набор барьеров B>
       <child-beans/>
      </bean>
      <bean class="net.soft_systems.crypto.beans.structure.VulnerabilityGroupBean"net.soft_systems.crypto.beans.structure.VulnerabilityGroupBean id="vulnerabilities"vulnerabilities name="Множество уязвимостей V"Множество уязвимостей V>
       <child-beans/>
      </bean>
      <bean class="net.soft_systems.crypto.beans.structure.RelationGroupBean"net.soft_systems.crypto.beans.structure.RelationGroupBean id="relations"relations name="Связи"Связи>
       <child-beans>
        <bean class="net.soft_systems.crypto.beans.structure.RelationBean"net.soft_systems.crypto.beans.structure.RelationBean id="S1 - O1"S1 - O1 name="S1 - O1"S1 - O1 resource="O1"O1 subject="S1"S1/>
       </child-beans>
      </bean>
     </child-beans>
    </bean>
    <bean class="net.soft_systems.crypto.beans.policy.PolicyGroupBean"net.soft_systems.crypto.beans.policy.PolicyGroupBean id="policies"policies name="Политика безопасности"Политика безопасности>
     <child-beans>
      <bean class="net.soft_systems.crypto.beans.policy.RightGroupBean"net.soft_systems.crypto.beans.policy.RightGroupBean id="rights"rights name="Множество прав доступа"Множество прав доступа>
       <child-beans>
        <bean class="net.soft_systems.crypto.beans.policy.RightBean"net.soft_systems.crypto.beans.policy.RightBean id="чтение"чтение name="Чтение данных"Чтение данных/>
        <bean class="net.soft_systems.crypto.beans.policy.RightBean"net.soft_systems.crypto.beans.policy.RightBean id="запись"запись name="Запись данных"Запись данных/>
        <bean class="net.soft_systems.crypto.beans.policy.RightBean"net.soft_systems.crypto.beans.policy.RightBean id="создать"создать name="Создание сеанса"Создание сеанса/>
       </child-beans>
      </bean>
      <bean class="net.soft_systems.crypto.beans.policy.HRUPolicy"net.soft_systems.crypto.beans.policy.HRUPolicy id="hru"hru name="Дискреционная модель Харрисона-Руззо-Ульмана"Дискреционная модель Харрисона-Руззо-Ульмана>
       <child-beans>
        <bean class="net.soft_systems.crypto.beans.policy.RightMatrixBean"net.soft_systems.crypto.beans.policy.RightMatrixBean id="right-matrix"right-matrix name="Матрица прав доступа"Матрица прав доступа/>
        <bean class="net.soft_systems.crypto.beans.policy.CommandGroupBean"net.soft_systems.crypto.beans.policy.CommandGroupBean id="commands"commands name="Множество команд"Множество команд>
         <child-beans>
          <bean class="net.soft_systems.crypto.beans.policy.CommandBean"net.soft_systems.crypto.beans.policy.CommandBean id="создатьСеанс"создатьСеанс name="создатьСеанс"создатьСеанс>
           <conditions/>
           <operations/>
          </bean>
          <bean class="net.soft_systems.crypto.beans.policy.CommandBean"net.soft_systems.crypto.beans.policy.CommandBean id="удалитьСеанс"удалитьСеанс name="удалитьСеанс"удалитьСеанс>
           <conditions/>
           <operations/>
          </bean>
          <bean class="net.soft_systems.crypto.beans.policy.CommandBean"net.soft_systems.crypto.beans.policy.CommandBean id="датьПрава"датьПрава name="датьПрава"датьПрава>
           <conditions/>
           <operations/>
          </bean>
          <bean class="net.soft_systems.crypto.beans.policy.CommandBean"net.soft_systems.crypto.beans.policy.CommandBean id="удалитьПрава"удалитьПрава name="удалитьПрава"удалитьПрава>
           <conditions/>
           <operations/>
          </bean>
         </child-beans>
        </bean>
       </child-beans>
      </bean>
     </child-beans>
    </bean>
    <bean class="net.soft_systems.integrator.TopicBean"net.soft_systems.integrator.TopicBean id="realization"realization name="Динамическая модель"Динамическая модель>
     <child-beans>
      <bean class="net.soft_systems.crypto.beans.process.ProcessDiagramBean"net.soft_systems.crypto.beans.process.ProcessDiagramBean id="process-diagram"process-diagram name="Диаграмма взаимодействия процессов"Диаграмма взаимодействия процессов>
       <child-beans/>
      </bean>
      <bean class="net.soft_systems.crypto.beans.process.ProcessGroupBean"net.soft_systems.crypto.beans.process.ProcessGroupBean id="processes"processes name="Процессы системы"Процессы системы>
       <child-beans>
        <bean auto-create="false"false class="net.soft_systems.crypto.beans.process.ProcessBean"net.soft_systems.crypto.beans.process.ProcessBean id="P1"P1 name="P1 / Ресурс O1"P1 / Ресурс O1 resource="O1"O1 x="55.0"55.0 y="34.0"34.0>
         <vars><![CDATA[RSA rsa = new RSA();                  ]]>         </vars>
         <child-beans>
          <bean class="net.soft_systems.crypto.beans.process.NodeGroupBean"net.soft_systems.crypto.beans.process.NodeGroupBean id="nodes"nodes name="Узлы процесса"Узлы процесса>
           <child-beans>
            <bean class="net.soft_systems.crypto.beans.process.NodeBean"net.soft_systems.crypto.beans.process.NodeBean id="key_in"key_in name="P1.key_in / in"P1.key_in / in type="1"1 x="37.0"37.0 y="51.0"51.0/>
            <bean class="net.soft_systems.crypto.beans.process.NodeBean"net.soft_systems.crypto.beans.process.NodeBean id="out"out name="P1.out / out"P1.out / out type="2"2 x="85.0"85.0 y="51.0"51.0/>
           </child-beans>
          </bean>
          <bean class="net.soft_systems.crypto.beans.process.MethodGroupBean"net.soft_systems.crypto.beans.process.MethodGroupBean id="methods"methods name="Методы процесса"Методы процесса>
           <child-beans>
            <bean class="net.soft_systems.crypto.beans.process.MethodBean"net.soft_systems.crypto.beans.process.MethodBean id="onCreate"onCreate name="onCreate"onCreate>            </bean>
            <bean class="net.soft_systems.crypto.beans.process.MethodBean"net.soft_systems.crypto.beans.process.MethodBean id="onDestroy"onDestroy name="onDestroy"onDestroy>            </bean>
            <bean class="net.soft_systems.crypto.beans.process.MethodBean"net.soft_systems.crypto.beans.process.MethodBean id="onRecieve"onRecieve name="onRecieve"onRecieve><![CDATA[long key[]=(long [])recv("key_in");
rsa.setOpenKey(key[0],key[1]);
logDataMessage("Получен открытый ключ", "e="+key[0]+" n="+key[1]);
                        ]]>            </bean>
            <bean class="net.soft_systems.crypto.beans.process.MethodBean"net.soft_systems.crypto.beans.process.MethodBean id="do_send"do_send name="do_send"do_send><![CDATA[long message=12345435;
logDataMessage("Исходный текст",message);
long code = rsa.encode( message );
logDataMessage("Зашифрованный текст",code);
send("out",new Long(code));
                        ]]>            </bean>
           </child-beans>
          </bean>
         </child-beans>
        </bean>
        <bean auto-create="false"false class="net.soft_systems.crypto.beans.process.ProcessBean"net.soft_systems.crypto.beans.process.ProcessBean id="P2"P2 name="P2 / Субъект S1"P2 / Субъект S1 subject="S1"S1 x="54.0"54.0 y="123.0"123.0>
         <vars><![CDATA[RSA rsa = new RSA();                  ]]>         </vars>
         <child-beans>
          <bean class="net.soft_systems.crypto.beans.process.NodeGroupBean"net.soft_systems.crypto.beans.process.NodeGroupBean id="nodes"nodes name="Узлы процесса"Узлы процесса>
           <child-beans>
            <bean class="net.soft_systems.crypto.beans.process.NodeBean"net.soft_systems.crypto.beans.process.NodeBean id="in"in name="P2.in / in"P2.in / in type="1"1 x="36.0"36.0 y="140.0"140.0/>
            <bean class="net.soft_systems.crypto.beans.process.NodeBean"net.soft_systems.crypto.beans.process.NodeBean id="key_out"key_out name="P2.key_out / out"P2.key_out / out type="2"2 x="84.0"84.0 y="140.0"140.0/>
           </child-beans>
          </bean>
          <bean class="net.soft_systems.crypto.beans.process.MethodGroupBean"net.soft_systems.crypto.beans.process.MethodGroupBean id="methods"methods name="Методы процесса"Методы процесса>
           <child-beans>
            <bean class="net.soft_systems.crypto.beans.process.MethodBean"net.soft_systems.crypto.beans.process.MethodBean id="onCreate"onCreate name="onCreate"onCreate>            </bean>
            <bean class="net.soft_systems.crypto.beans.process.MethodBean"net.soft_systems.crypto.beans.process.MethodBean id="onDestroy"onDestroy name="onDestroy"onDestroy>            </bean>
            <bean class="net.soft_systems.crypto.beans.process.MethodBean"net.soft_systems.crypto.beans.process.MethodBean id="onRecieve"onRecieve name="onRecieve"onRecieve><![CDATA[Long lcode=(Long)recv("in");
long code=lcode.longValue();
logDataMessage("Шифротекст",code);
long decode = rsa.decode( code );
logDataMessage("Расшифрованный текст",decode);                        ]]>            </bean>
            <bean class="net.soft_systems.crypto.beans.process.MethodBean"net.soft_systems.crypto.beans.process.MethodBean id="makeKeys"makeKeys name="makeKeys"makeKeys><![CDATA[long x = 10000;
long y = 20000;
long fi;
long p,q,e;
for ( p = x; !Numerical.isPrime( p ); p++ ) ;
for ( q = y + 2; !Numerical.isPrime( q ); q++ ) ;
rsa.setSecureKey(p,q);
logDataMessage("Секретный ключ","p=" + p +" q="+q);
fi=rsa.getFi();
for ( e = fi / 10; Numerical.gcd( e, fi ) != 1; e++ ) ;
rsa.checkOpenKey(e);
logDataMessage("Открытый ключ", "e=" + e+" n="+rsa.getN());
long open_key[]=new long[2];
open_key[0]=e;
open_key[1]=rsa.getN();
send("key_out",open_key);
                        ]]>            </bean>
           </child-beans>
          </bean>
         </child-beans>
        </bean>
       </child-beans>
      </bean>
      <bean class="net.soft_systems.crypto.beans.process.ChannelGroupBean"net.soft_systems.crypto.beans.process.ChannelGroupBean id="channels"channels name="Каналы передачи данных"Каналы передачи данных>
       <child-beans>
        <bean class="net.soft_systems.crypto.beans.process.ChannelBean"net.soft_systems.crypto.beans.process.ChannelBean id="P2.key_out / out -> [P1.key_in / in]"P2.key_out / out -> [P1.key_in / in] name="P2.key_out / out -> [P1.key_in / in]"P2.key_out / out -> [P1.key_in / in]>
         <src-node node="key_out"key_out process="P2"P2/>
         <dst-node node="key_in"key_in process="P1"P1/>
        </bean>
        <bean class="net.soft_systems.crypto.beans.process.ChannelBean"net.soft_systems.crypto.beans.process.ChannelBean id="P1.out / out -> [P2.in / in]"P1.out / out -> [P2.in / in] name="P1.out / out -> [P2.in / in]"P1.out / out -> [P2.in / in]>
         <src-node node="out"out process="P1"P1/>
         <dst-node node="in"in process="P2"P2/>
        </bean>
       </child-beans>
      </bean>
     </child-beans>
    </bean>
    <bean class="net.soft_systems.integrator.TopicBean"net.soft_systems.integrator.TopicBean id="modelling"modelling name="Моделирование"Моделирование>
     <child-beans>
      <bean class="net.soft_systems.crypto.beans.model.MessageGroupBean"net.soft_systems.crypto.beans.model.MessageGroupBean id="messages"messages name="Сообщения"Сообщения/>
     </child-beans>
    </bean>
    <bean class="net.soft_systems.crypto.beans.ConfigGroupBean"net.soft_systems.crypto.beans.ConfigGroupBean id="config"config name="Настройки среды"Настройки среды>
     <child-beans>
      <bean class="net.soft_systems.integrator.TopicBean"net.soft_systems.integrator.TopicBean id="avail-policies"avail-policies name="Модели политики безопасности"Модели политики безопасности>
       <child-beans>
        <bean class="net.soft_systems.crypto.beans.policy.ClassRefBean"net.soft_systems.crypto.beans.policy.ClassRefBean class-ref="net.soft_systems.crypto.beans.policy.HRUPolicy"net.soft_systems.crypto.beans.policy.HRUPolicy id="Дискреционная модель Харрисона-Руззо-Ульмана"Дискреционная модель Харрисона-Руззо-Ульмана name="Дискреционная модель Харрисона-Руззо-Ульмана"Дискреционная модель Харрисона-Руззо-Ульмана/>
       </child-beans>
      </bean>
     </child-beans>
    </bean>
   </child-beans>
  </bean>
 </beans>
