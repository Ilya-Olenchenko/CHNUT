<?xml version="1.0" encoding="Cp1251"?>
 <beans>
  <bean id="root" name="Система криптографической защиты" class="net.soft_systems.integrator.TopicBean">
   <child-beans>
    <bean id="structure" name="Статическая модель" class="net.soft_systems.crypto.beans.structure.StructureGroupBean">
     <child-beans>
      <bean id="structure-diagram" name="Диаграмма статической модели" class="net.soft_systems.crypto.beans.structure.StructureBean">
       <child-beans/>
      </bean>
      <bean id="resources" name="Защищаемая область O" class="net.soft_systems.crypto.beans.structure.ResourceGroupBean">
       <child-beans>
        <bean id="Ресурс" name="Ресурс" class="net.soft_systems.crypto.beans.structure.ResourceBean" x="125.0" y="25.0"/>
       </child-beans>
      </bean>
      <bean id="subjects" name="Субъекты S" class="net.soft_systems.crypto.beans.structure.SubjectGroupBean">
       <child-beans>
        <bean id="Субъект" name="Субъект" class="net.soft_systems.crypto.beans.structure.SubjectBean" x="225.0" y="25.0"/>
       </child-beans>
      </bean>
      <bean id="threats" name="Область угроз T" class="net.soft_systems.crypto.beans.structure.ThreatGroupBean">
       <child-beans/>
      </bean>
      <bean id="protections" name="Системные защиты M" class="net.soft_systems.crypto.beans.structure.ProtectionGroupBean">
       <child-beans/>
      </bean>
      <bean id="boundaries" name="Набор барьеров B" class="net.soft_systems.crypto.beans.structure.BoundaryGroupBean">
       <child-beans/>
      </bean>
      <bean id="vulnerabilities" name="Множество уязвимостей V" class="net.soft_systems.crypto.beans.structure.VulnerabilityGroupBean">
       <child-beans/>
      </bean>
      <bean id="relations" name="Связи" class="net.soft_systems.crypto.beans.structure.RelationGroupBean">
       <child-beans>
        <bean id="Субъект - Ресурс" name="Субъект - Ресурс" class="net.soft_systems.crypto.beans.structure.RelationBean" subject="Субъект" resource="Ресурс"/>
       </child-beans>
      </bean>
     </child-beans>
    </bean>
    <bean id="policies" name="Политика безопасности" class="net.soft_systems.crypto.beans.policy.PolicyGroupBean">
     <child-beans>
      <bean id="rights" name="Множество прав доступа" class="net.soft_systems.crypto.beans.policy.RightGroupBean">
       <child-beans/>
      </bean>
     </child-beans>
    </bean>
    <bean id="realization" name="Динамическая модель" class="net.soft_systems.integrator.TopicBean">
     <child-beans>
      <bean id="process-diagram" name="Диаграмма взаимодействия процессов" class="net.soft_systems.crypto.beans.process.ProcessDiagramBean">
       <child-beans/>
      </bean>
      <bean id="processes" name="Процессы системы" class="net.soft_systems.crypto.beans.process.ProcessGroupBean">
       <child-beans>
        <bean id="Sender" name="Sender / Ресурс Ресурс" class="net.soft_systems.crypto.beans.process.ProcessBean" x="25.0" y="25.0" resource="Ресурс" auto-create="false">
         <vars>         </vars>
         <child-beans>
          <bean id="nodes" name="Узлы процесса" class="net.soft_systems.crypto.beans.process.NodeGroupBean">
           <child-beans>
            <bean id="Выход" name="Sender.Выход / out" class="net.soft_systems.crypto.beans.process.NodeBean" x="55.0" y="42.0" type="2"/>
           </child-beans>
          </bean>
          <bean id="methods" name="Методы процесса" class="net.soft_systems.crypto.beans.process.MethodGroupBean">
           <child-beans>
            <bean id="onCreate" name="onCreate" class="net.soft_systems.crypto.beans.process.MethodBean">            </bean>
            <bean id="onDestroy" name="onDestroy" class="net.soft_systems.crypto.beans.process.MethodBean">            </bean>
            <bean id="onRecieve" name="onRecieve" class="net.soft_systems.crypto.beans.process.MethodBean">            </bean>
            <bean id="do_send" name="do_send" class="net.soft_systems.crypto.beans.process.MethodBean"><![CDATA[int iDataSize = 10000;
byte data[]=Binary.random(iDataSize);
logDataMessage("Открытый текст",data);

DES crypter=new DES();
crypter.setIV(Binary.setFromHex("7836 ECD6 C5F0 37B6"));
crypter.setKey(Binary.setFromHex("9B58 086D 9BF9 CD96 C6EA 3381 B1B4 F637"));

//Crypting
int iWholeTime = 0;
int iDataPtr = 0;
TimeUtil t=new TimeUtil();
while (iDataPtr < iDataSize) {
  byte data16[] = new byte[16];
  int iLocalI = 0, iLocalI2;
  while ((iLocalI < 16) && (iDataPtr < iDataSize)) {
    data16[iLocalI] = data[iDataPtr];
    iDataPtr++;
    iLocalI++;
  }

  t.start();
  byte code[]=crypter.encodeData(data16,crypter.MODE_CFB);
  t.finish();
  iWholeTime += t.millisec();

  iDataPtr -= iLocalI;
  for (int i = 0; i < iLocalI; i++) {
    data[iDataPtr] = code[i];
    iDataPtr++;
  }
}
logDataMessage("Время шифрования ", iWholeTime);
logDataMessage("Зашифрованный текст",data);
send("Выход",data);                                                                                                                                                ]]>            </bean>
           </child-beans>
          </bean>
         </child-beans>
        </bean>
        <bean id="Receiver" name="Receiver / Субъект Субъект" class="net.soft_systems.crypto.beans.process.ProcessBean" x="189.0" y="25.0" subject="Субъект" auto-create="false">
         <vars>         </vars>
         <child-beans>
          <bean id="nodes" name="Узлы процесса" class="net.soft_systems.crypto.beans.process.NodeGroupBean">
           <child-beans>
            <bean id="Вход" name="Receiver.Вход / in" class="net.soft_systems.crypto.beans.process.NodeBean" x="171.0" y="42.0" type="1"/>
           </child-beans>
          </bean>
          <bean id="methods" name="Методы процесса" class="net.soft_systems.crypto.beans.process.MethodGroupBean">
           <child-beans>
            <bean id="onCreate" name="onCreate" class="net.soft_systems.crypto.beans.process.MethodBean">            </bean>
            <bean id="onDestroy" name="onDestroy" class="net.soft_systems.crypto.beans.process.MethodBean">            </bean>
            <bean id="onRecieve" name="onRecieve" class="net.soft_systems.crypto.beans.process.MethodBean"><![CDATA[DES crypter=new DES();
crypter.setIV(Binary.setFromHex("7836 ECD6 C5F0 37B6"));
crypter.setKey(Binary.setFromHex("9B58 086D 9BF9 CD96 C6EA 3381 B1B4 F637"));

byte data[]=(byte[])recv("Вход");
int iDataSize = data.length;

//DeCrypting
int iWholeTime = 0;
int iDataPtr = 0;
TimeUtil t=new TimeUtil();
while (iDataPtr < iDataSize) {
  byte data16[] = new byte[16];
  int iLocalI = 0, iLocalI2;
  while ((iLocalI < 16) && (iDataPtr < iDataSize)) {
    data16[iLocalI] = data[iDataPtr];
    iDataPtr++;
    iLocalI++;
  }

  t.start();
  byte code[]=crypter.decodeData(data16,crypter.MODE_CFB);
  t.finish();
  iWholeTime += t.millisec();

  iDataPtr -= iLocalI;
  for (int i = 0; i < iLocalI; i++) {
    data[iDataPtr] = code[i];
    iDataPtr++;
  }
}

logDataMessage("Время расшифрования",iWholeTime);
logDataMessage("Расшифрованный текст",data);                                                                                                                                                ]]>            </bean>
           </child-beans>
          </bean>
         </child-beans>
        </bean>
       </child-beans>
      </bean>
      <bean id="channels" name="Каналы передачи данных" class="net.soft_systems.crypto.beans.process.ChannelGroupBean">
       <child-beans>
        <bean id="Sender.Выход / out -> [Receiver.Вход / in]" name="Sender.Выход / out -> [Receiver.Вход / in]" class="net.soft_systems.crypto.beans.process.ChannelBean">
         <src-node process="Sender" node="Выход"/>
         <dst-node process="Receiver" node="Вход"/>
        </bean>
       </child-beans>
      </bean>
     </child-beans>
    </bean>
    <bean id="modelling" name="Моделирование" class="net.soft_systems.integrator.TopicBean">
     <child-beans>
      <bean id="messages" name="Сообщения" class="net.soft_systems.crypto.beans.model.MessageGroupBean"/>
     </child-beans>
    </bean>
    <bean id="config" name="Настройки среды" class="net.soft_systems.crypto.beans.ConfigGroupBean">
     <child-beans>
      <bean id="avail-policies" name="Модели политики безопасности" class="net.soft_systems.integrator.TopicBean">
       <child-beans>
        <bean id="Дискреционная модель Харрисона-Руззо-Ульмана" name="Дискреционная модель Харрисона-Руззо-Ульмана" class="net.soft_systems.crypto.beans.policy.ClassRefBean" class-ref="net.soft_systems.crypto.beans.policy.HRUPolicy"/>
       </child-beans>
      </bean>
     </child-beans>
    </bean>
   </child-beans>
  </bean>
 </beans>
